#!/usr/bin/sh
cache_dir="$HOME/.cache/jeros"
last_seen="$cache_dir/email_notify"

mkdir -p "$cache_dir"
touch "$last_seen"

count=$(email unread | wc -l)
last=$(email unread | sort | tail -n 1)

if [ "$(cat $last_seen)" != "$last" ] && [ "$count" -gt 0 ] || [ "$1" != 'cron' ]; then
	echo "$last" > "$last_seen"
	# different notify
	notify 'Mail' "You've got $count new mail."
	play "$HOME/Media/Audio/Recordings/bow.mp3" vol 0.25
fi
